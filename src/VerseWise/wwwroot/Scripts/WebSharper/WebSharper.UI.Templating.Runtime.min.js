(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Templating=c.Templating||{};e=d.Runtime=d.Runtime||{};f=e.Server=e.Server||{};g=f.TemplateInitializer=f.TemplateInitializer||{};h=b&&b.Obj;i=f.TemplateInstances=f.TemplateInstances||{};j=f.Handler=f.Handler||{};k=f.ProviderBuilder=f.ProviderBuilder||{};l=f.TemplateInstance=f.TemplateInstance||{};m=e.Client=e.Client||{};n=b&&b.Collections;o=n&&n.Dictionary;p=a.IntelliFactory;q=p&&p.Runtime;r=b&&b.Arrays;s=b&&b.Unchecked;t=c&&c.Var$1;u=b&&b.Operators;v=c&&c.Doc;w=c&&c.Client;x=w&&w.Templates;y=b&&b.Slice;z=c&&c.BindVar;A=a.console;B=c&&c.View;C=b&&b.Activator;D=n&&n.HashSet;E=b&&b.Enumerator;F=b&&b.Seq;G=a.System;H=G&&G.Guid;g.$cctor=function(){g.$cctor=a.ignore;g.initialized=new o.New$5();};g=f.TemplateInitializer=q.Class({get_Vars:function(){g.$cctor();return this.vars;},get_Id:function(){g.$cctor();return this.id;},InitInstance:function(I){var J,K,L,M,N,O,P,Q;g.$cctor();K=g.GetHolesFor(I);L=this.vars;for(M=0,N=L.length-1;M<=N;M++){O=r.get(L,M);P=O[1];Q=O[0];if(!K.ContainsKey(Q))K.set_Item(Q,s.Equals(P,0)?{$:8,$0:Q,$1:t.Create$1("")}:s.Equals(P,1)?{$:13,$0:Q,$1:t.Create$1(0)}:s.Equals(P,2)?{$:9,$0:Q,$1:t.Create$1(false)}:u.FailWith("Invalid value type"));}this.instance=new l.New({$:0,$0:K},v.get_Empty());},get_Instance:function(){g.$cctor();return q.GetOptional(this.instance).$0;},$postinit:function(I){g.$cctor();x.RunFullDocTemplate([]);},$init:function(I){g.$cctor();},$preinit:function(I){var J,K,L,M,N,O,P,Q;g.$cctor();this.InitInstance(I);J=self.document.querySelectorAll("[ws-var^='"+I+"::']");for(K=0,L=J.length-1;K<=L;K++){M=J[K];N=M.getAttribute("ws-var");O=y.string(N,{$:1,$0:I.length+2},null);P=this.get_Instance().Hole(O);Q={$:P.$,$0:N,$1:P.$1};x.GlobalHoles().set_Item(Q.$0,Q);g.applyVarHole(M,P);}}},h,g);g.applyVarHole=function(I,J){var K;g.$cctor();switch(J.$==9?1:J.$==10?2:J.$==11?3:J.$==12?4:J.$==13?5:J.$==0?(K=J.$0,6):J.$==1?(K=J.$0,6):J.$==2?(K=J.$0,6):J.$==14?(K=J.$0,6):J.$==4?(K=J.$0,6):J.$==5?(K=J.$0,6):J.$==6?(K=J.$0,6):J.$==7?(K=J.$0,6):J.$==3?(K=J.$0,6):0){case 0:g.applyTypedVarHole(z.StringApply(),J.$1,I);break;case 1:g.applyTypedVarHole(z.BoolCheckedApply(),J.$1,I);break;case 2:g.applyTypedVarHole(z.IntApplyChecked(),J.$1,I);break;case 3:g.applyTypedVarHole(z.IntApplyUnchecked(),J.$1,I);break;case 4:g.applyTypedVarHole(z.FloatApplyChecked(),J.$1,I);break;case 5:g.applyTypedVarHole(z.FloatApplyUnchecked(),J.$1,I);break;case 6:A.warn("Not a var hole: ",K);break;}};g.applyTypedVarHole=function(I,J,K){var L;g.$cctor();L=I(J);L[0](K);B.Sink(L[1](K),L[2]);};g.GetOrAddHoleFor=function(I,J,K){var L,M,N,O;g.$cctor();L=g.GetHolesFor(I);M=(N=null,[L.TryGetValue(J,{get:function(){return N;},set:function(P){N=P;}}),N]);return M[0]?M[1]:(O=K(),(L.set_Item(J,O),O));};g.GetHolesFor=function(I){var J,K,L;g.$cctor();J=(K=null,[g.initialized.TryGetValue(I,{get:function(){return K;},set:function(M){K=M;}}),K]);return J[0]?J[1]:(L=new o.New$5(),(g.initialized.set_Item(I,L),L));};g.get_Initialized=function(){g.$cctor();return g.initialized;};g.New=q.Ctor(function(I,J){g.$cctor();h.New.call(this);this.vars=J;q.SetOptional(this,"instance",null);this.id=I;},g);i=f.TemplateInstances=q.Class({},h,i);i.GetInstance=function(I){return(C.Instances())[I].get_Instance();};i.New=q.Ctor(function(){h.New.call(this);},i);j.AfterRenderQ2$203$42=function(I,J){return function(K){J({Vars:i.GetInstance(I),Target:K,Event:null});};};j.EventQ2$189$36=function(I,J){return function(K){return function(L){return J({Vars:i.GetInstance(I),Target:K,Event:L});};};};j.CompleteHoles=function(I,J,K){var M,N,O,P,Q;function L(R,S){var T;return N.Contains(R)?null:(T=s.Equals(S,0)?g.GetOrAddHoleFor(I,R,function(){return{$:8,$0:R,$1:t.Create$1("")};}):s.Equals(S,1)?g.GetOrAddHoleFor(I,R,function(){return{$:13,$0:R,$1:t.Create$1(0)};}):s.Equals(S,2)?g.GetOrAddHoleFor(I,R,function(){return{$:9,$0:R,$1:t.Create$1(false)};}):u.FailWith("Invalid value type"),(M.set_Item(R,T),{$:1,$0:T}));}M=new o.New$5();N=new D.New$3();O=E.Get(J);try{while(O.MoveNext()){P=O.Current();Q=P.$0;N.Add(Q);M.set_Item(Q,P);}}finally{if(typeof O=="object"&&"Dispose"in O)O.Dispose();}return[F.append(J,r.choose(function(R){return L(R[0],R[1]);},K)),{$:0,$0:M}];};j.AfterRenderQ2=function(I,J,K,L){return{$:7,$0:J,$1:function(M){L({Vars:K(),Target:M,Event:null});}};};j.EventQ2=function(I,J,K,L){return{$:5,$0:J,$1:function(M){return function(N){return L({Vars:K(),Target:M,Event:N});};}};};k=f.ProviderBuilder=q.Class({},h,k);k.New=q.Ctor(function(I){var J;h.New.call(this);this.i=null;this.k=(J=H.NewGuid(),a.String(J));this.h=[];this.s=I;},k);k.New$1=q.Ctor(function(){var I;h.New.call(this);this.i=null;this.k=(I=H.NewGuid(),a.String(I));this.h=[];q.SetOptional(this,"s",null);},k);l=f.TemplateInstance=q.Class({Hole:function(I){return this.allVars.get_Item(I);},get_Doc:function(){return this.doc;}},h,l);l.New=q.Ctor(function(I,J){h.New.call(this);this.doc=J;this.allVars=I.$==0?I.$0:u.FailWith("Should not happen");},l);m.AfterRenderQ2$57$26=function(I){return function(){I();};};m.Box=a.id;}(self));
